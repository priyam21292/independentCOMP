'''
Identify communities in a random undirected graph

	- Take user input for number of vertices, p-value and density
	- Generate a random-graph using the user input
	- Generate all the possible subgraphs of the graph
	- For each subset, check if it's density id greater than threshold density
'''
import graph 
import itertools
from math import factorial

# Take user inputs
V = int(input ("Enter No. of Vertices: ") )
p = float(input ("Enter p-value: ") )
threshold = float(input ("Enter threshold density: ") )

# Create a random-graph using the input
G = graph.random_graph(V,p)

def max_edge(n):
	m_edge = int(factorial(n) / factorial(2) / factorial(n-2))
	return m_edge

community = []
for i in range(3,V):
	min_edges = int(threshold * max_edge(i))
	possible_combinations = list(itertools.combinations(range(V),i))
	for j in range(0,len(possible_combinations)):
		temp = []
		for k in range(0,i-1):
			if ((possible_combinations[j][k], possible_combinations[j][k+1]) in G):
				temp.extend([possible_combinations[j][k],possible_combinations[j][k+1]])
				list(set(temp))
				if set(temp) == set(possible_combinations[j]):
					if (len(set(temp))) > min_edges:
						community.append(set(temp))
			else:
				break



print(community)
print(len(community))

'''
To get the subsets, I was applying the following logic - 
	- Loop through each vertice
	- Start with the first vertice, and explore the neighbours.
	- If the neighbours are connected by an edge, there is a cycle or a subgraph.
	- Store each subgraph in a list.

To check for the subsets that qualify as a community given the threshold - 
	- Iterate through the list and check for the number of vertices (V) and number of edges (E)
	- Apply the formula 2 * E/ (V*(V-1))
	- If the value is greater than the threshold, print the subset.
'''

'''
########Output#########
Enter No. of Vertices: 20
Enter p-value: 0.6
Enter threshold density: 0.7
[{0, 2, 4}, {0, 2, 5}, {0, 2, 6}, {0, 2, 7}, {0, 8, 2}, {0, 9, 2}, {0, 2, 11}, {0, 2, 12}, {0, 2, 14}, {0, 16, 2}, {0, 3, 7}, {0, 3, 13}, {0, 3, 14}, {0, 3, 15}, {0, 16, 3}, {0, 17, 3}, {0, 18, 3}, {0, 5, 6}, {0, 5, 7}, {0, 8, 5}, {0, 9, 5}, {0, 10, 5}, {0, 11, 5}, {0, 12, 5}, {0, 13, 5}, {0, 5, 15}, {0, 16, 5}, {0, 8, 6}, {0, 9, 6}, {0, 10, 6}, {0, 11, 6}, {0, 13, 6}, {0, 6, 14}, {0, 6, 15}, {0, 17, 6}, {0, 18, 6}, {0, 8, 10}, {0, 8, 11}, {0, 8, 13}, {0, 8, 14}, {0, 8, 16}, {0, 8, 18}, {0, 9, 10}, {0, 9, 13}, {0, 9, 14}, {0, 9, 16}, {0, 9, 17}, {0, 9, 18}, {0, 9, 19}, {0, 10, 12}, {0, 10, 13}, {0, 10, 15}, {0, 16, 10}, {0, 17, 10}, {0, 10, 18}, {0, 10, 19}, {0, 11, 12}, {0, 17, 11}, {0, 18, 11}, {0, 19, 11}, {0, 12, 14}, {0, 12, 15}, {0, 16, 12}, {0, 18, 12}, {0, 13, 14}, {0, 13, 15}, {0, 17, 13}, {0, 18, 13}, {0, 14, 15}, {0, 16, 14}, {0, 17, 14}, {0, 18, 14}, {0, 16, 17}, {0, 16, 18}, {0, 16, 19}, {0, 17, 18}, {0, 17, 19}, {1, 2, 4}, {1, 2, 5}, {1, 2, 6}, {1, 2, 7}, {8, 1, 2}, {1, 2, 9}, {1, 2, 11}, {1, 2, 12}, {1, 2, 14}, {16, 1, 2}, {1, 4, 5}, {1, 4, 6}, {1, 4, 7}, {8, 1, 4}, {1, 10, 4}, {1, 11, 4}, {1, 4, 12}, {1, 4, 14}, {16, 1, 4}, {1, 19, 4}, {1, 5, 6}, {1, 5, 7}, {8, 1, 5}, {1, 5, 9}, {1, 10, 5}, {1, 11, 5}, {1, 12, 5}, {1, 13, 5}, {1, 5, 15}, {16, 1, 5}, {8, 1, 6}, {1, 6, 9}, {1, 10, 6}, {1, 11, 6}, {1, 13, 6}, {1, 6, 14}, {1, 6, 15}, {1, 6, 17}, {1, 18, 6}, {8, 1, 7}, {1, 10, 7}, {1, 12, 7}, {1, 13, 7}, {1, 14, 7}, {1, 15, 7}, {16, 1, 7}, {1, 17, 7}, {1, 19, 7}, {1, 12, 14}, {1, 12, 15}, {16, 1, 12}, {1, 18, 12}, {1, 13, 14}, {1, 13, 15}, {1, 13, 17}, {1, 18, 13}, {1, 14, 15}, {16, 1, 14}, {1, 14, 17}, {1, 18, 14}, {1, 18, 17}, {1, 19, 17}, {2, 4, 5}, {2, 4, 6}, {2, 4, 7}, {8, 2, 4}, {2, 10, 4}, {2, 11, 4}, {2, 4, 12}, {2, 4, 14}, {16, 2, 4}, {2, 19, 4}, {2, 5, 6}, {2, 5, 7}, {8, 2, 5}, {9, 2, 5}, {2, 10, 5}, {2, 11, 5}, {2, 12, 5}, {2, 13, 5}, {2, 5, 15}, {16, 2, 5}, {8, 2, 6}, {9, 2, 6}, {2, 10, 6}, {2, 11, 6}, {2, 13, 6}, {2, 6, 14}, {2, 6, 15}, {17, 2, 6}, {2, 18, 6}, {8, 2, 7}, {2, 10, 7}, {2, 12, 7}, {2, 13, 7}, {2, 14, 7}, {2, 15, 7}, {16, 2, 7}, {17, 2, 7}, {2, 19, 7}, {8, 2, 10}, {8, 2, 11}, {8, 2, 13}, {8, 2, 14}, {8, 16, 2}, {8, 2, 18}, {9, 2, 10}, {9, 2, 13}, {9, 2, 14}, {16, 9, 2}, {9, 2, 17}, {9, 2, 18}, {9, 2, 19}, {2, 11, 12}, {17, 2, 11}, {18, 2, 11}, {19, 2, 11}, {2, 12, 14}, {2, 12, 15}, {16, 2, 12}, {2, 18, 12}, {2, 14, 15}, {16, 2, 14}, {17, 2, 14}, {2, 18, 14}, {16, 17, 2}, {16, 2, 18}, {16, 2, 19}, {8, 3, 7}, {10, 3, 7}, {3, 12, 7}, {3, 13, 7}, {3, 14, 7}, {3, 15, 7}, {16, 3, 7}, {17, 3, 7}, {19, 3, 7}, {3, 13, 14}, {3, 13, 15}, {17, 3, 13}, {18, 3, 13}, {3, 14, 15}, {16, 3, 14}, {17, 3, 14}, {18, 3, 14}, {16, 3, 15}, {18, 3, 15}, {16, 17, 3}, {16, 18, 3}, {16, 19, 3}, {17, 18, 3}, {19, 17, 3}, {4, 5, 6}, {4, 5, 7}, {8, 4, 5}, {9, 4, 5}, {10, 4, 5}, {11, 4, 5}, {12, 4, 5}, {13, 4, 5}, {4, 5, 15}, {16, 4, 5}, {8, 4, 6}, {9, 4, 6}, {10, 4, 6}, {11, 4, 6}, {4, 13, 6}, {4, 6, 14}, {4, 6, 15}, {17, 4, 6}, {18, 4, 6}, {8, 4, 7}, {10, 4, 7}, {4, 12, 7}, {4, 13, 7}, {4, 14, 7}, {4, 15, 7}, {16, 4, 7}, {17, 4, 7}, {19, 4, 7}, {8, 10, 4}, {8, 11, 4}, {8, 4, 13}, {8, 4, 14}, {8, 16, 4}, {8, 18, 4}, {10, 4, 12}, {10, 4, 13}, {10, 4, 15}, {16, 10, 4}, {17, 10, 4}, {10, 18, 4}, {10, 19, 4}, {11, 4, 12}, {17, 11, 4}, {18, 11, 4}, {19, 11, 4}, {4, 12, 14}, {4, 12, 15}, {16, 4, 12}, {18, 4, 12}, {4, 14, 15}, {16, 4, 14}, {17, 4, 14}, {18, 4, 14}, {16, 17, 4}, {16, 18, 4}, {16, 19, 4}, {8, 5, 6}, {9, 5, 6}, {10, 5, 6}, {11, 5, 6}, {13, 5, 6}, {5, 6, 14}, {5, 6, 15}, {17, 5, 6}, {18, 5, 6}, {8, 5, 7}, {10, 5, 7}, {12, 5, 7}, {13, 5, 7}, {5, 14, 7}, {15, 5, 7}, {16, 5, 7}, {17, 5, 7}, {19, 5, 7}, {8, 10, 5}, {8, 11, 5}, {8, 13, 5}, {8, 5, 14}, {8, 16, 5}, {8, 18, 5}, {9, 10, 5}, {9, 13, 5}, {9, 5, 14}, {16, 9, 5}, {9, 5, 17}, {9, 18, 5}, {9, 19, 5}, {10, 12, 5}, {10, 13, 5}, {10, 5, 15}, {16, 10, 5}, {17, 10, 5}, {10, 18, 5}, {10, 19, 5}, {11, 12, 5}, {17, 11, 5}, {18, 11, 5}, {19, 11, 5}, {12, 5, 14}, {12, 5, 15}, {16, 12, 5}, {18, 12, 5}, {13, 5, 14}, {13, 5, 15}, {17, 13, 5}, {13, 18, 5}, {16, 5, 15}, {18, 5, 15}, {16, 17, 5}, {16, 18, 5}, {16, 19, 5}, {8, 10, 6}, {8, 11, 6}, {8, 13, 6}, {8, 6, 14}, {8, 16, 6}, {8, 18, 6}, {9, 10, 6}, {9, 13, 6}, {9, 6, 14}, {16, 9, 6}, {9, 6, 17}, {9, 18, 6}, {9, 19, 6}, {10, 12, 6}, {10, 13, 6}, {10, 6, 15}, {16, 10, 6}, {17, 10, 6}, {10, 18, 6}, {10, 19, 6}, {11, 12, 6}, {17, 11, 6}, {18, 11, 6}, {19, 11, 6}, {13, 6, 14}, {13, 6, 15}, {17, 13, 6}, {18, 13, 6}, {15, 6, 14}, {16, 6, 14}, {17, 6, 14}, {18, 6, 14}, {16, 6, 15}, {18, 6, 15}, {17, 18, 6}, {17, 19, 6}, {8, 10, 7}, {8, 11, 7}, {8, 13, 7}, {8, 14, 7}, {8, 16, 7}, {8, 18, 7}, {10, 12, 7}, {10, 13, 7}, {10, 15, 7}, {16, 10, 7}, {17, 10, 7}, {10, 18, 7}, {10, 19, 7}, {12, 14, 7}, {12, 15, 7}, {16, 12, 7}, {18, 12, 7}, {13, 14, 7}, {15, 13, 7}, {17, 13, 7}, {18, 13, 7}, {15, 14, 7}, {16, 14, 7}, {17, 14, 7}, {18, 14, 7}, {16, 15, 7}, {18, 15, 7}, {16, 17, 7}, {16, 18, 7}, {16, 19, 7}, {17, 18, 7}, {17, 19, 7}, {8, 10, 12}, {8, 10, 13}, {8, 10, 15}, {8, 16, 10}, {8, 17, 10}, {8, 10, 18}, {8, 10, 19}, {8, 11, 12}, {8, 17, 11}, {8, 18, 11}, {8, 19, 11}, {8, 13, 14}, {8, 13, 15}, {8, 17, 13}, {8, 18, 13}, {8, 14, 15}, {8, 16, 14}, {8, 17, 14}, {8, 18, 14}, {8, 16, 17}, {8, 16, 18}, {8, 16, 19}, {9, 10, 12}, {9, 10, 13}, {9, 10, 15}, {16, 9, 10}, {9, 10, 17}, {9, 10, 18}, {9, 10, 19}, {9, 13, 14}, {9, 13, 15}, {9, 13, 17}, {9, 18, 13}, {9, 14, 15}, {16, 9, 14}, {9, 14, 17}, {9, 18, 14}, {16, 9, 17}, {16, 9, 18}, {16, 9, 19}, {9, 18, 17}, {9, 19, 17}, {10, 12, 14}, {10, 12, 15}, {16, 10, 12}, {10, 18, 12}, {10, 13, 14}, {10, 13, 15}, {17, 10, 13}, {10, 18, 13}, {16, 10, 15}, {10, 18, 15}, {16, 17, 10}, {16, 10, 18}, {16, 10, 19}, {17, 10, 18}, {17, 10, 19}, {11, 12, 14}, {11, 12, 15}, {16, 11, 12}, {18, 11, 12}, {17, 18, 11}, {19, 17, 11}, {12, 14, 15}, {16, 12, 14}, {17, 12, 14}, {18, 12, 14}, {16, 12, 15}, {18, 12, 15}, {16, 17, 12}, {16, 18, 12}, {16, 19, 12}, {13, 14, 15}, {16, 13, 14}, {17, 13, 14}, {18, 13, 14}, {16, 13, 15}, {18, 13, 15}, {17, 18, 13}, {17, 19, 13}, {16, 14, 15}, {18, 14, 15}, {16, 17, 14}, {16, 18, 14}, {16, 19, 14}, {17, 18, 14}, {17, 19, 14}, {16, 17, 15}, {16, 18, 15}, {16, 19, 15}, {16, 17, 18}, {16, 17, 19}]
'''